---
title: "Analyzing centralitty measures for a sexual network of gonorrhea transmission"
subtitle: "SOC 280 Fall 2021"
author: "J Steven Raquel"

mainfont: Times New Roman
sansfont: Times New Roman
output:
  pdf_document
geometry: "margin=1in"
fontsize: 12pt
csl: american-sociological-association.csl
header-includes:
  - \usepackage{setspace}
fig_width: 6
fig_height: 4

---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(sna)
library(igraph)
library(epimdr) # for gonnet data
library(CINNA) # for pca_centralities()
library(car) # for leveneTest()
library(factoextra) # for nbclust
library(kableExtra) # nicer tables
library(knitr) # kable
library(ergm) # ERGMS
library(coda)
library(statnet)
library(latticeExtra)
library(GGally) # ggnet2 
library(foreign)
library(ergm.userterms)
library(Matrix)
source(here::here("functions.R"))
```

\doublespacing

# Introduction

Contact tracing for sexually transmitted diseases (STDs) such as gonorrhea, chlamydia, syphilis etc. is a persistent epidemiological problem, as it depends on individuals getting routinely tested as well as informing their sexual partners of their positive diagnosis should they receive one. Compounding this with the fact that many of these positive cases can be symptomless but still contagious creates a serious issue. Gonorrhea in particular is a disease that can be asymptomatic in both men and women who have it, that can go so far as causing infertility or lead to a life-threatening condition.

This dataset concerns a localised outbreak of *Neisseria gonorrehoeae* (gonorrhea) in an indigenous First Nations community located in Alberta, Canada. It was originally analyzed in a paper by Prithwish De, et al. (2004), in which they used measures of network centrality (e.g. information centrality) to determine the association between the risk of infection between members of the network and their position within the network itself. The data was sourced from an earlier 2001 study by the same authors (De, et al. 2001) in which they formulated a plan to address the outbreak. 

# Background

### On Neisseria gonorrheoeae

Gonorrhea is a sexually transmitted disease/infection (STD/STI) which can be transmitted orally, vaginally or anally. Although it can have many serious side effects, it can also be symptomless, leading to individuals unknowingly infecting their partners. When untreated, it also makes HIV more susceptible to transmission, making gonorrhea itself a risk factor for the propagation of HIV. In Canada, reported cases increased by 38.9% between 2003 and 2012, with rates highest in the 20-24 year old age group. It is the second most commonly reported STI in Canada (Totten, et al. 2015).

### On First Nations in Alberta, Canada

According to the 2016 Canadian census, approximately 7% of Albertans identify as First Nations, one of the indigenous groups native to Canada, compared to approximately 5% throughout all of Canada. First Nations peoples experience a disproportionate prevalence of STDs in their population relative to other groups in Canada, due at least in part to cultural differences, and lack of access to resoruces such as those in more urbanized areas and more populated by non-indigenous people. 

## Data 

### Data Collection

The sociometric approach for enumerating a sexual network entails an iterative process in which the subject names past sexual partners, who are them traced and interviewed to identify whether they are linked and also to identify other contacts in the network (Doherty 2005). Conversely, the egocentric approach bases the network entirely on the information volunteered by the original subject. 

The design suffers from incomplete-network bias when partners cannot be traced or recruited for a variety of reasons (Doherty 2005). As is typical for data collection processes in which information is nominated by the ego, and especially in the sensitive case where sexual partnering is involved, there is bound to be some information missing from the data. e.g. Self-reported behavior from an ego may not necessarily reflect their practices in reality. The data is subject to an individual possibly withholding information, or simply not having the information at all. For example, an individual may be reluctant to disclose the identity of a sexual partner if they are in a monogamous relationship and to disclose this event would mean owning up to infidelity, or perhaps if the sex was in exchange for money i.e. sex work. It could also be that the sex occurred in an anonymous context and they simply do not have the information on the individual. Societal attitudes towards sex and sexual health both in a Wester/Canadian context and also in an indigenous/Aboriginal context can and should be kept in mind when drawing conclusions from this data.

The contact tracing of sexual partners is relegated to those who have a positive test result, and since such individuals may have markedly different positions within a network, tracing a network consisting solely of STI-positive partners has an inherent bias. In our case, since the STD clinical reports don't contain complete sexual contact information, the original index case could not be identified. Questions about sexual risk factors and drug use were also omitted due to a lack of respondents (De 2001), and the lack of information on sexual practices e.g. condom usage, drug use could be considered a blind spot in this data.

### Data Structure

Wasserman and Faust (1994) define "cutpoints" and "bridges" as nodes and ties respectively that cause the graph in which they are contained to have less components if they were to be taken out from the graph. In other words, they are the nodes or ties that connect what would be otherwise unconnected sub-graphs. These are crucial in sexual network analysis because these nodes and ties are the difference between whether a certain network may propagate an STI outbreak or not.

This dataset, constructed in the form of an adjacency matrix, contains 89 nodes, one of which is the "event" of attending a bar (i.e. when a node has a tie with this bar node, it means they attend the bar). Two of these nodes (denoted by `x` and `x2`) are missing information about their gender which is otherwise indicated by an `m` or `f` in the label of the respective node, followed by a number with which to differentiate them.

\singlespacing

## Methods

```{r data-prep, echo = F}
# library(epimdr) is loaded
data(gonnet)
# data is loaded as 'gonnet'
nodes <- rownames(gonnet)
# indices where "x" and "x2 are
drop <- which(nodes %in% c("x", "x2"))
# drop rows/columns with these numbers
gonnet <- gonnet[-drop, -drop]
# symmetrized graph (undirected)
gonnet <- symmetrize(gonnet, rule = "weak")
nodes <- nodes[-drop]
rownames(gonnet) <- nodes
colnames(gonnet) <- nodes
# creating bar attendance vector
attended_bar <- gonnet["b", ] == 1
# creating gender vector
gender <- ifelse(grepl("m", nodes), yes = "M", no = NA)
gender <- ifelse(grepl("f", nodes), yes = "F", no = gender)

# dropping bar object from this network
gonnet_nobar <- gonnet[-1,]
gonnet_nobar <- gonnet_nobar[,-1]

# creating network object
gonnet_net_nobar <- network(gonnet_nobar, directed = F)

# adding bar attendance on graphs
network::set.vertex.attribute(gonnet_net_nobar, 'bar', attended_bar[-1])
# adding gender to the graph
network::set.vertex.attribute(gonnet_net_nobar, 'gender', gender[-1])

gonnet_bar <- gonnet
# creating igraph object
gonnet_bar_ig <- graph_from_adjacency_matrix(gonnet_bar)

(pc <- proper_centralities(gonnet_bar_ig)) %>% 
  capture.output() %>%
  invisible()

degree <- sna::degree(gonnet_bar, gmode = "graph")
gonnet_df <- data.frame(
  nodes,
  attended_bar,
  gender,
  degree
)

# adding partners column to dataset
gonnet_df <- gonnet_df %>% 
  mutate(partners = ifelse(attended_bar == T, yes = degree - 1, no = degree))
gonnet_df$partners[gonnet_df$nodes == "b"] <- NA

# adding partners to vertex attributes
network::set.vertex.attribute(gonnet_net_nobar, 'partners', gonnet_df$partners[-1])

```

```{r network-objects, echo = F}

# creating a network object of the two-mode network with the bar
gonnet_net_bar <- network(gonnet_bar, directed = F)

# adding gender to the graph
network::set.vertex.attribute(gonnet_net_bar, 'gender', gender)
network::set.vertex.attribute(gonnet_net_bar, 'degree', degree)

# adding a linetype attribute so that the edges to the bar are dashed lines
edgelist <- as.matrix(gonnet_net_bar, matrix.type="edgelist")
network::set.edge.attribute(gonnet_net_bar, "lty", 
                            ifelse(edgelist[,2] == 1, 2, 1))

```


```{r sociogram-ggnet2-bar, echo = F}
set.seed(62)
ggnet2(gonnet_net_bar,
       color = "gender", 
       palette = c("F" = "#F8766D", "M" = "#00BFC4", "NA" = "grey"),
       mode = "fruchtermanreingold",
       label = T,
       edge.lty = "lty", 
       size = 5,
       label.size = 5/2)

```

\doublespacing

Looking at this initial sociogram, where the bar node is firmly in the center, we see that it has 17 ties to other individual nodes, which themselves have connections to at least one other node in the rest of the network. The remaining 74 edges in the dataset are between individuals. Of these 74 edges, approximately 90.5% of them are between male and female nodes, and approximately 48.6% of them are between bar-attendees and non-attendees. 

While the majority of ties are between individuals of the opposite sex, e.g. male-to-female or female-to-male, there are a minority of instances where individuals have a tie to individuals of the same sex, e.g. `m112` has ties with both `m106` and `m107`, who both in turn have ties to at least one female node. 

The node `m010` is also unique in that it happens to have ties to one female node (`f024`) and one male node (`m018`), the latter of which in turn has a tie with a female node (`f023`). The idea of men who have sex with men (MSM) or women who have sex with women (WSW) acting as bridging nodes between otherwise disparate sexual networks was something considered in the exploratory analysis but there just wasn't enough data to delve deeper into this subject.

### Distribution of ties

```{r figure-gender-degree-histogram, echo=FALSE, warning = F}
# boxplot of degree by gender
gonnet_df %>%
  filter(nodes != "b") %>%
  ggplot(aes(x = partners, fill = gender)) +
  geom_histogram(binwidth =1,position = "dodge", colour = "black", lwd = 0.75) + 
  ggtitle("Histogram of # of Partners, by Gender") +
  theme_bw() + 
  scale_x_discrete("# of Partners", breaks = 0:7, labels = 0:7, limits = c(0:7)) + 
  ylab("Node Count")
```

Note that the distribution in number of partners is more right skewed for women than it is for men, owing to the fact that about a third of more women in this network had 1 partner compared to men who had 1 partner. Generally men's number of partners is more spread between 1-2 partners. The distribution is similar for both genders when looking at those having more than 2 partners. 

This histogram, which depicts a histogram of number of partners, colored by bar attendance, shows that a large number of non-bar patrons only have one partner; this is mostly bolstered by the fact that most of the members of the network do not frequent the bar, and also there are a sizeable number of individuals in the network who were simply alters of an ego who did attend the bar and do not have any other alters themselves.

### Centrality Measures

\doublespacing

According to Borgatti and Everett (2006), _centrality_ is a summary index of a node's position in a graph, based on sums or averages of one of several things: 1) the number of edges the node has, 2) the length of the paths that end up at the node, or 3) the proportion of paths that contain the node inside of it (not as an endpoint).

Different measures of centrality depend on functions of one of these aspects and communicate different things about a node, depending on the algorithm for the centrality measure. In this paper, we're going to look different kinds of centrality as a means of quantifying the impact of individual nodes on the network.

Network centrality was covered in De, at al (2004) but in the context of the connected network, and we want to expand on this by looking at centrality within the disconnected network (which does not contain the bar node).

```{r sociogram-nobar, echo = F}
set.seed(62)
# GGally is loaded
ggnet2(gonnet_net_nobar, 
       color = "gender", 
       palette = c("F" = "#F8766D", "M" = "#00BFC4"), 
       shape = "bar", 
       mode = "fruchtermanreingold", 
       label = T,
       size = 5,
       label.size = 5/2)
```

There are about 9 or so subcomponents of this graph; notice that the largest among them has 3 bar attendees within it, 2 of whom have at least 5 ties to other individuals. Notice there is one isolate where a male node attended the bar but otherwise has no ties to any other node. There also a a series of smaller sub-components where there is only one edge between two nodes, one of whom is a bar attendee. Note the presence of a "6-cycle" in the largest subcomponent, in which 6 separate nodes are jointly connected through one another. This is the only such appearance of a k-cycle in the entire network. The largest subcomponent of the graph includes 38 of the 86 nodes in the network, or approximately 44% of all egos. 

### Degree Centrality

For an undirected network such as this, then the degree of some node $i$ is just the count of ties it has to other nodes. Supposing we had some adjacency matrix $A$, then the degree of node $i$ is equal to 

$$D_i = \sum_j a_{ij}$$
where $j$ is the number of nodes in the network and $a_{ij} = 1$ given that node $i$ has a tie with node $j$, and zero otherwise. Note that in this network those who attended the bar have a tie with the bar node to represent that relationship, hence in order to treat degree as a means of quantifying sexual partners, we added in an adjustment in the form of a new variable called `partners` which subtracts 1 from the degree of those bar attendees. 

As noted earlier in Figure 3, the largest component contains 2 nodes (`m017` and `f011`) with degrees of 6 and 7 respectively. Noting their respective positions in the network, we see that a high degree centrality doesn't necessarily imply a large impact on the network in general, as long as an ego's alters do not themselves have a high degree centrality. The converse is also true where an ego can have a small degree but still be connected to an alter than itself has a high degree, e.g. `f014` was a bar attendee with a degree of one, connecting itself to `m208` who accordingly has 4 other alters, some of whom have more among them. 

It's possible in fact for an ego to have a high degree but whose alters themselves have a very low degree, such that their respective sub-component is not very large, e.g. `f004` which has an outdegree of 5, but all of its alters have a degree of only 1 or 2. 

Other forms of centrality are better at measuring this impact, for example, eigenvector centrality, which will be discussed later in this literature.

```{r table-male-female-degree, echo = F}
gonnet_df %>% 
  filter(nodes != "b") %>%
  group_by(gender) %>%
  summarize(average_partners = mean(partners) %>% round(3)) %>% 
  kbl(col.names = c("Gender", "Mean Number of Partners")) %>%
  kable_classic()
```

We observe from the data that on average, men have a slightly higher number of sexual partners than women in this sample.

```{r table-bar-degree, echo = F}
gonnet_df %>% 
  filter(nodes != "b") %>%
  group_by(attended_bar) %>%
  summarize(average_partners = mean(partners) %>% round(3)) %>% 
  kbl(col.names = c("Attended Bar", "Mean Number of Partners")) %>%
  kable_classic()
```

We further observe that those who attend the bar end up having an average of about 1.6 sexual partners compared to as many as 2.1 partners from those who did. Again, these two quantities are technically dependent (owing to the fact that these are not isolated samples, i.e. the bar attendees can be partnered with the non-attendees), so we can't formally compare them with a t-test, but it is something to take note of going forward. Later on in the literature we will bar attendance as a data attribute when developing an exponential random graph model (ERGM), in order to model this relationship, should it exist.

```{r figure-bar-degree, echo=FALSE, warning = F}
# boxplot of degree by bar attendance
gonnet_df %>%
  filter(nodes != "b") %>%
  ggplot(aes(x = partners, fill = attended_bar)) +
  geom_histogram(binwidth = 1, position = "dodge", colour = "black", lwd = 0.75) + 
  ggtitle("Histogram of # of Partners, by Bar Attendance") +
  theme_bw() +
  scale_x_discrete("# of Partners", breaks = 0:7, labels = 0:7, limits = c(0:7)) +
  ylab("Node Count")
```

In this case, we are seeing difference in the two distributions of men and women; there are many more women (10+) who had only one sexual partner in this network, with the remaining numbers between comparatively small. Conversely the majority of the men are split between either one or two partners. Overall the distributions for 3 or more partners are similar across genders. 

The analysis gave that the overall average degree for the directed graph is approximately 1, implying that on average individuals named one sexual partner. It's important to note that many outer edges have an degree of 0, which skews down the mean calculation somewhat. 

The implication of this observation is two-fold. For one, rather than most individuals in the network having many sexual partners, the implication of how degree is distributed in this network is that most individuals have as few as one, but there is a minority of individuals (of both genders) who named more. 

### Eigenvector Centrality

Eigenvector centrality is calculated both as a function of a node's degree but also as a function of the degree of the nodes it is connected to. In other words, a node with a high eigenvector centrality is well-connected to nodes that are themselves well-connected. Contextually, a node in this setting would have a high number of partners who also have a high number of partners.

```{r eigenvector-centrality, echo = F}
eigenvectors <- eigen(gonnet_net_nobar)
eig <- eigenvectors$vectors[,1] %>% as.numeric()

# adding eigenvector centrality as a vertex attribute to the networkr
network::set.vertex.attribute(gonnet_net_nobar, 'eig', eig)
network::set.vertex.attribute(gonnet_net_nobar, 'bar', attended_bar[-1])
```

\doublespacing

## Exponential Random Graph Model (ERGM)

Exponential random graph models (ERGMs) are a family of statistical models for social networks that permit inference about prominent patterns in the data, given the presence of other network structures (Carrington and Scott, 2011). For a given set of $n$ actors, an ERGM models an observed network $x$ by assigning a probability to every network of $n$ actors, and the form of such a model is as follows

$$\Pr(X = x) = \frac{1}{k} \exp\{\sum_A \eta_Ag_A(x) \}$$
where the sum is over all configuration types $A$; 

* $\eta_A$ is a parameter correpsonding to configuration type $A$; 
* $g_A(x)$ is the _network statistic_ for $A$ and is the number of configurations $A$ observed in $x$
* $k$ normalizes this to be a proper probability distribution.

This equation implies that there is a probability distribution of all possible networks with $n$ nodes, with each such network having their own distinct probability.

The ERGM model requires a one-mode network, so we can create one by dropping the bar node from the data (while still retaining the information of bar attendance as a vertex attribute).

Figure 3 represents the network in which the bar node is not a part of the graph; instead bar attendance is regarded as a vertex attribute in the data, as is gender. There are 7 sub-components of size greater than 2. Most interestingly is the component that comprises almost half (39) of all of the nodes in the dataset, despite containing as few as 3 bar attendees. 

When fitting the ERGM model, first we started with the simplest model that only models the number of edges (this would be akin to an intercept-only model in logistic regression). We then built several more models which only had one parameter, and then compared the Akaike Information Criteria (AIC) of the models to determine which among these model parameters were worth including. Among the model parameters fit were homophily (`nodematch`), heterophily (`nodemix`) and degree (`degree`). 

### Markov Chain Monte Carlo (MCMC)

A Markov Chain is a stochastic process that goes from one state to another, with the future state $X_{t+1}$ depending only on the current state $X_t$ at time $t$, i.e.

$$\Pr(X_{t+1} = x | X_t = x_t)$$

A Monte Carlo process refers to a simulation that samples many random values from a posterior distribution of interest. Hence a Markov Chain Monte Carlo (MCMC) simulation is a simulation of a random process whose future value depends only on the current value.


#### Metropolis-Hastings Algorithm

A common MCMC algorithm is the Metropolis-Hastings algorithm, in which the process "randomly walks" starting from some $\theta_0$. To determine whether the process advances, a "candidate value" $\theta\*$ is generated by sampling from the proposal distribution $g(\theta\*| \theta_{s-1})$ at iteration $s$. We then derive the Metropolis-Hastings acceptance ratio $\eta$, which is a ratio of the estimated distribution at time $\theta$ and at the proposed time $\theta_n$. Then we derive the acceptance probability $\rho$ by taking the minimum between the acceptance ratio $\eta$ and 1,  i.e. $\rho = \text{min}(1, \eta)$. We sample $U \sim \text{Uni}(0,1)$ to and compare it to $\rho$. If $U < \rho$ then we accept the candidate value such that $\theta_s = \theta\*$ Otherwise we repeat another iteration with $\theta_s$ as before. 

\singlespacing

### Model Fitting

```{r small-ergms, echo = T, cache = T, include = F}
# quitely is ran here so not to output all the model building steps
set.seed(55)
# library(ergm) is loaded
# simple model
ergm_model1 <- quietly(ergm)(gonnet_net_nobar ~ edges)$result
# homophily
ergm_model2 <- quietly(ergm)(gonnet_net_nobar ~ edges + nodematch("bar"))$result
# using symmetric model
ergm_model3 <- quietly(ergm)(gonnet_net_nobar ~ edges + degree(d = c(2:3)))$result
# heterophily of gender
ergm_model4 <- quietly(ergm)(gonnet_net_nobar ~ edges + nodemix("gender"))$result
# nodefactor
ergm_model5 <- quietly(ergm)(gonnet_net_nobar ~ edges + nodefactor("bar"))$result
# heterophily on bar attendance
ergm_model6 <- quietly(ergm)(gonnet_net_nobar ~ edges + nodemix("bar"))$result
```

```{r table-model-comparison, echo = F,  results = 'hide', fig.keep = 'all'}
model_list <- list(ergm_model1, ergm_model2, ergm_model3,
                   ergm_model4, ergm_model5, ergm_model6)

aics <- sapply(model_list, FUN = get_from_summary, object = "aic")
formulas <- sapply(model_list, FUN = get_from_summary, object = "formula")

df <- matrix(data = c(formulas, aics),
              nrow = length(aics),
              ncol = 2) %>% 
  as.data.frame() %>%
  rename(formula = V1, aic = V2)

df %>% 
  kbl(caption = "Table of Akaike Information Criteria for each ERGM model") %>% 
  kable_classic()  

```

```{r ergm-model-fitting, echo = T, results = 'hide'}
set.seed(55)

ergm_model7 <- quietly(ergm)(gonnet_net_nobar ~ 
                      edges + 
                      degree(d = c(1:3)) + 
                      nodemix("gender"))$result


ergm_model8 <- quietly(ergm)(gonnet_net_nobar ~ 
                      edges + 
                      degree(d = c(1:3)) + 
                      nodemix("gender") + 
                      nodematch("bar"))$result
```

```{r lrtest-curve, echo = F, fig.height = 2.5}
lrtest <- lmtest::lrtest(ergm_model8, ergm_model7)
# test statistic
LRT <- lrtest$Chisq[2]

# randomly sampling from a chi-squared distribution with 1 df
chisq_plot_df <- data.frame(values = rchisq(1000, df = 1))

# 95% critical value, if LRT > critical value, reject H0
critical_value <- qchisq(p = 0.05, df = 1, lower.tail = F)

# plotting the distribution with rejection region
ggplot(chisq_plot_df, aes(x = values, ymin = 0, ymax = 1)) +
    geom_density() +
    geom_vline(xintercept = LRT, linetype = "dashed", colour = "blue",
              show.legend = T) +
    geom_vline(xintercept = critical_value, linetype = "solid", colour = "red",
              show.legend = T) +
    ggtitle("Chi-squared distribution with 1 degree of freedom") +
    scale_linetype_discrete(labels = c("95% critical value", 
                                      "LRT test statistic")) +
    ylab("Density") +                                
    theme_bw() +
    ylim(c(0,1))
```

### Model Diagnostics

When using MCMC chains our goal is for it to _converge_. 
We can diagnose this by looking at traceplots of the MCMC chain as well as the density curve. 
We want to see the traceplot have constant variance (homoskedascticity) and for the density plot to be centered at 0 and shaped like a bell curve.

```{r model-diagnostics}
mcmc.diagnostics(ergm_model8, which = "plots")
```

### Interpretation

Recall the equation for the ERGM model

$$\log \big[ \frac{\Pr(Y_{ij} = 1 | y_{ij}^C)}{\Pr(Y_{ij} = 0 | y_{ij}^C)}  \big] = \sum_{A(Y_{ij}) \eta_A d_A(y)}$$

Hence we have,

$$\log \big[ \frac{\Pr(Y_{ij} = 1 | y_{ij}^C)}{\Pr(Y_{ij} = 0 | y_{ij}^C)}  \big] = -5.1948 + 2.7430 \text{Degree}_1 + 1.4678 \text{Degree}_2 + (3.4534 \times \text{Gender}_{FM}) + (1.7138 \times \text{Gender}_{MM}) + (-0.7061 \times \text{Bar})$$

```{r model-interpretation}
ergm_model8
```





# Discussion


# Conclusions

\newpage

\doublespacing

# References

De P, Singh AE, Wong T, et al. 2004. "Sexual network analysis of a gonorrhea     outbreak." *Sexually Transmitted Infections* 80:280-285.

Carrington, P. and Scott, J., 2011. *The SAGE handbook of social network          analysis. 1st ed.* Los Angeles [etc.]: SAGE Publications, pp.484-500.

Irene A. Doherty, Nancy S. Padian, Cameron Marlow, Sevgi O. Aral, Determinants and Consequences of Sexual Networks as They Affect the Spread of Sexually Transmitted Infections, The Journal of Infectious Diseases, Volume 191, Issue Supplement_1, February 2005, Pages S42–S54, https://doi.org/10.1086/425277

Wasserman, S. and Faust, K., 1994. Social network analysis: methods and applications. Cambridge: Cambridge University Press.

DE, PRITHWISH MHSc*; SINGH, AMEETA E. BMBS, MSc, FRCPC†; WONG, TOM MD, MPH, FRCPC*; YACOUB, WADIEH MBBCh, MSc, FRCPC‡ Outbreak of Neisseria gonorrhoeae in Northern Alberta, Canada, Sexually Transmitted Diseases: June 2003 - Volume 30 - Issue 6 - p 497-501 

Valente TW. Social networks and health: models, methods, and 
applications. New York: Oxford University Press, 2010.

Public Health Agency of Canada. Report on sexually transmitted infections in Canada: 2011. Centre for Communicable Diseases and Infection Control, Infectious Disease Prevention and Control Branch, Public Health Agency of Canada; 2014. 2011. http://publications.gc.ca/site/eng/469949/publication.html.

\newpage

# Appendix


```{r goodness-of-fit}
model8_gof <- gof(ergm_model8, GOF = ~ model)
# goodness of fit for model statistics
model8_gof$pval.model
```